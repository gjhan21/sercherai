# A股数据获取与分析方案（开发版）

## 1. 目标与范围
1. 每个交易日输出 10 只 A 股推荐候选。
2. 输出内容包含：推荐理由、风险标签、失效条件、有效期。
3. 面向 C 端展示，不提供交易指令。

## 2. 数据来源与获取

### 2.1 行情数据
1. 日线/分钟线：开高低收、成交量、成交额、涨跌幅。
2. 复权因子：前复权/后复权计算基础。
3. 停复牌、涨跌停状态。

建议来源：
1. `Tushare Pro`（主数据源）。
2. `AkShare`（补充与校验）。
3. 交易所公开数据（上交所/深交所）做关键字段核验。

### 2.2 基本面数据
1. 三大报表：利润表、资产负债表、现金流量表。
2. 关键财务指标：ROE、毛利率、净利率、资产负债率、经营现金流。
3. 业绩预告、业绩快报、分红送转信息。

### 2.3 资金与交易行为数据
1. 北向资金净流入。
2. 融资融券余额变化。
3. 主力资金流向（若数据源可用）。
4. 龙虎榜公开信息。

### 2.4 事件与公告数据
1. 上交所/深交所公告。
2. 政策类新闻、行业事件、公司重大事项。
3. 资讯版权合规来源（商用必须授权）。

## 3. 数据采集架构

### 3.1 分层模型
1. `raw_*`：原始落库，不改字段。
2. `ods_*`：标准化（代码、时间、单位、空值处理）。
3. `dwd_*`：特征层（因子、标签、风险信号）。

### 3.2 调度节奏
1. 盘前任务（08:00-09:00）：同步前一交易日财务、公告、资金。
2. 盘中任务（可选）：分钟行情增量与事件抓取。
3. 盘后任务（15:30后）：全量校验、因子重算、推荐生成。

### 3.3 稳定性要求
1. 任务幂等：重复执行不会重复入库。
2. 失败重试：指数退避 + 死信告警。
3. 补数机制：任意日期可重跑。

## 4. 数据质量管理
1. 完整性：关键字段缺失率阈值告警。
2. 一致性：多源字段对比（收盘价、成交额等）。
3. 时效性：任务延迟、数据更新时间监控。
4. 异常值：价格跳变、成交额异常、复权异常拦截。

## 5. A股选股分析方法

### 5.1 股票池构建
1. 全市场母池：沪深京。
2. 过滤：剔除 `ST/*ST`、长期停牌、流动性过低标的。
3. 风险过滤：重大负面公告、退市风险、高风险财务预警。

### 5.2 因子体系（100分）
1. 基本面 `30`：营收增速、净利增速、ROE、经营现金流。
2. 资金面 `20`：北向净流入、融资融券变化、主力资金行为。
3. 趋势面 `20`：1M/3M 相对强弱、均线结构、回撤控制。
4. 估值面 `15`：PE/PB 分位、行业相对估值。
5. 事件面 `15`：财报、订单、政策与产业催化。

综合分公式：
`Score = 0.30*F_fundamental + 0.20*F_flow + 0.20*F_trend + 0.15*F_valuation + 0.15*F_event`

### 5.3 组合约束
1. 单行业最多 2 只。
2. 风格分散：成长/价值/红利均衡。
3. 流动性约束：满足客户可交易性要求。

## 6. 每日推荐生成流程
1. 数据准备：更新交易日、行情、公告、财务、资金。
2. 因子计算：全市场打分出 Top30。
3. 规则筛选：按行业/风险/流动性筛到 Top10。
4. 文案生成：每只输出 3 条理由 + 风险 + 失效条件。
5. 发布留痕：记录模型版本、数据版本、发布时间。

## 7. 输出规范（给客户端）
1. 标的：代码、名称、行业。
2. 分数：综合分、子分项。
3. 理由：基本面/资金面/事件面三条。
4. 风险：低/中/高 + 风险提示文本。
5. 失效条件：如财报不及预期、跌破关键位、事件反转。
6. 有效期：默认 T+5。

## 8. 回测与评估
1. 回测窗口：3-5 年滚动回测。
2. 指标：收益率、最大回撤、胜率、夏普、行业暴露。
3. 命中率：T+1/T+5/T+20。
4. 线上监控：因子漂移、命中率下滑、异常波动告警。

## 9. 合规要求
1. 页面明确“非投资建议”。
2. 使用有授权的数据源与资讯源。
3. 推荐发布与审核留痕（操作者、版本、时间）。

## 10. 开发落地建议（阶段）
1. Phase 1：先做沪深300+中证500，日频模型，输出 Top10。
2. Phase 2：扩展全市场，增加事件因子和风控规则。
3. Phase 3：增加模型自适应调参与自动复盘报告。

## 11. 待确认项
1. 最终数据源供应商及商用授权范围。
2. 推荐发布时间（盘前/盘中/盘后）。
3. 推荐有效期规则（固定 T+5 或动态）。
4. 是否支持行业主题榜单并行输出。


# 期货套利与操作指导方案（开发版）

## 1. 目标
1. 每日识别并输出国内期货套利机会（跨期、跨品种、期现）。
2. 输出标准化操作指导：方向、点位、仓位、止盈止损、失效条件。
3. 不下交易指令，仅提供策略观点和风险提示。

## 2. 功能模块

### 2.1 套利机会扫描
1. 跨期套利：同品种不同合约价差偏离识别。
2. 跨品种套利：高相关品种价差偏离识别。
3. 期现套利：基差偏离识别（可得现货数据时启用）。

### 2.2 套利信号中心
1. 机会列表：价差、分位、Z-score、半衰期、流动性评分。
2. 状态机：`WATCH`（观察）-> `ENTRY`（可入场）-> `HOLD`（持有）-> `EXIT`（退出）。
3. 建议点位：入场区间、止盈区间、止损区间。

### 2.3 操作指导中心
1. 方向建议：`LONG_SPREAD`、`SHORT_SPREAD`、`NEUTRAL`。
2. 仓位建议：轻仓/标准/谨慎（基于波动率与保证金占用）。
3. 风险标签：`LOW|MEDIUM|HIGH`。
4. 失效条件：相关性失效、结构突变、政策事件、临近交割风险。

### 2.4 提醒与复盘
1. 条件提醒：到价、到时、波动率异常、止损触发。
2. 复盘报表：信号命中率、收益、最大回撤、平均持有期。

## 3. 数据需求

### 3.1 基础数据
1. 合约行情：tick/1m/日线 OHLCV。
2. 成交量、持仓量、主力合约切换。
3. 交易日历、涨跌停规则、手续费参数。

### 3.2 增强数据
1. 基差、仓单、库存（可接入时启用）。
2. 相关性矩阵（用于跨品种套利）。
3. 公告与政策事件标签（风控过滤）。

## 4. 信号计算
1. `Spread`：`P(contract_a) - k * P(contract_b)`。
2. `Percentile`：当前价差在历史窗口分位（建议 250 交易日）。
3. `Z-score`：标准化偏离（滚动均值/标准差）。
4. `Half-life`：均值回归速度估计。
5. 流动性评分：成交额、盘口深度、滑点估计。

## 5. 策略规则（示例）
1. 入场：`|Z-score| >= 2.0` 且分位极端且流动性达标。
2. 退出：`|Z-score| <= 0.5` 或达到止盈阈值。
3. 止损：`|Z-score| >= 3.0` 或相关性低于阈值。
4. 禁入：临近交割、涨跌停锁死、异常波动。

## 6. 风控体系
1. 前置风控：过滤高风险品种与不可交易时段。
2. 过程风控：单策略敞口上限、保证金占用上限、动态止损。
3. 熔断机制：连续亏损超过阈值自动暂停该策略。
4. 合规提示：每条建议必须带风险声明与有效期。

## 7. 输出规范（客户端）
1. 机会信息：品种、合约对、套利类型、评分、风险等级。
2. 点位信息：入场区间、止盈区间、止损区间。
3. 指导信息：方向、建议仓位、预计持有期。
4. 失效条件：触发后自动下线建议。

## 8. Admin 管理
1. 参数配置：窗口长度、阈值、白名单、黑名单。
2. 策略审核：研究员提交 -> 审核 -> 发布。
3. 风控管理：冻结策略、告警处理、恢复策略。
4. 绩效看板：命中率、收益、回撤、延迟。

## 9. API 规划
1. `GET /api/v1/futures/arbitrage/opportunities`
2. `GET /api/v1/futures/arbitrage/{id}`
3. `GET /api/v1/futures/guidance/{contract}`
4. `POST /api/v1/futures/alerts`
5. `GET /api/v1/futures/reviews`

## 10. 分阶段开发
1. Phase 1：跨期套利 + 基础操作指导 + 到价提醒。
2. Phase 2：跨品种/期现套利 + 复盘报表。
3. Phase 3：参数自适应优化 + 个性化风险偏好。


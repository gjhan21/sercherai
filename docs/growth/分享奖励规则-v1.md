# 分享奖励规则 v1

## 1. 目标
- 提高拉新注册数与有效付费转化。
- 控制刷奖励风险，保障成本可控。

## 2. 适用范围
- 客户端分享链接邀请的新用户。
- 新用户完成实名后，进入奖励判定链路。

## 3. 事件定义
- `INVITEE_REGISTERED` 被邀请用户注册成功。
- `INVITEE_VERIFIED` 被邀请用户实名通过。
- `INVITEE_FIRST_RECHARGE` 被邀请用户首次充值成功。
- `INVITEE_FIRST_MEMBERSHIP_PAY` 被邀请用户首次会员支付成功。

## 4. 奖励规则
1. 注册奖励  
条件：被邀请用户注册成功且 24 小时内实名通过。  
奖励：邀请人获得 `2` 元券（`COUPON`）。
2. 首充奖励  
条件：被邀请用户首次充值金额 `>= 30` 元。  
奖励：邀请人获得 `20` 元现金奖励（`CASH`）。
3. 会员首购奖励  
条件：被邀请用户完成会员首购支付。  
奖励：邀请人获得 `15` 天 VIP（`VIP_DAYS`）。
4. 被邀请用户奖励  
条件：首次通过分享链接注册并完成实名。  
奖励：新用户首充立减券 `10` 元。

## 5. 发放策略
- `COUPON` 立即发放。
- `CASH` 延迟 `T+1` 天发放，期间可风控拦截。
- `VIP_DAYS` 在首购成功后立即发放。

## 6. 封顶与预算
- 单邀请人日奖励上限：`200` 元等值。
- 单邀请人月奖励上限：`2000` 元等值。
- 活动总预算上限：`100000` 元，超出后自动降级为券奖励。

## 7. 风控规则
1. 同设备注册超过 `3` 个账号，标记 `SUSPECTED`。
2. 同实名信息重复触发奖励，直接拒绝。
3. 同支付账号被多个新用户复用，进入人工审核。
4. 同 IP 高频邀请（1 小时超过阈值）进入冻结队列。

## 7.1 规则配置化
1. 所有阈值支持在 Admin 动态配置。
2. 规则支持灰度生效（按时间窗口生效）。
3. 规则支持快速回滚到上一版本。

## 8. 状态流转
- 奖励记录状态：`PENDING -> ISSUED`。
- 风控命中：`PENDING -> FROZEN`。
- 审核拒绝：`PENDING/FROZEN -> REJECTED`。

## 9. 审核与审计
- 所有奖励审批操作写入审计日志。
- 日志字段：操作人、操作时间、原状态、新状态、原因。
- 提现审核同样写入审计日志并关联提现单号。

## 10. 指标看板
- 分享访问 UV
- 邀请注册数
- 邀请实名率
- 邀请首充率
- 邀请会员首购率
- 人均奖励成本
- 作弊拦截率
